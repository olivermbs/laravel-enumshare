<!DOCTYPE html>
<html>
<head>
    <title>EnumRuntime Browser Test</title>
</head>
<body>
    <h1>EnumRuntime Browser Test</h1>
    <p>Open browser console to see test results</p>
    <div id="results"></div>

    <script type="module">
        // Test data matching FlightBriefingStatus
        const testEnumData = {
            "name": "TestEnum",
            "fqcn": "App\\Enums\\TestEnum",
            "backingType": "int",
            "entries": [
                {
                    "key": "DRAFT",
                    "value": 0,
                    "label": "Draft",
                    "meta": { "color": "orange" }
                },
                {
                    "key": "SAVED",
                    "value": 1,
                    "label": "Saved",
                    "meta": { "color": "blue" }
                }
            ],
            "options": [
                { "value": 0, "label": "Draft" },
                { "value": 1, "label": "Saved" }
            ]
        };

        // Import and test the actual EnumRuntime if available
        try {
            // This would normally import from your actual EnumRuntime.ts
            // For now, we'll use a simplified version
            function createTestEnum(enumData) {
                const entriesMap = {};
                
                for (const entry of enumData.entries) {
                    entriesMap[entry.key] = entry;
                }
                
                const baseObject = {
                    name: enumData.name,
                    entries: enumData.entries,
                    options: enumData.options,
                    keys: () => enumData.entries.map(entry => entry.key),
                    values: () => enumData.entries.map(entry => entry.value ?? entry.key),
                    labels: () => enumData.entries.map(entry => entry.label),
                };
                
                const findEntryByValue = (value) => {
                    const entry = enumData.entries.find(entry => 
                        (entry.value !== null ? entry.value : entry.key) === value
                    );
                    return entry || null;
                };
                
                baseObject.from = findEntryByValue;
                baseObject.fromValue = findEntryByValue;
                
                return new Proxy(baseObject, {
                    get(target, prop) {
                        if (typeof prop === 'string' && entriesMap[prop]) {
                            return entriesMap[prop];
                        }
                        return target[prop];
                    }
                });
            }

            const testEnum = createTestEnum(testEnumData);
            
            console.log('=== Browser Test Results ===');
            console.log('Enum:', testEnum);
            console.log('Has from method:', typeof testEnum.from === 'function');
            console.log('Has fromValue method:', typeof testEnum.fromValue === 'function');
            console.log('from(1):', testEnum.from(1));
            console.log('fromValue(1):', testEnum.fromValue(1));
            console.log('Object.getOwnPropertyNames:', Object.getOwnPropertyNames(testEnum));
            console.log('hasOwnProperty("fromValue"):', testEnum.hasOwnProperty('fromValue'));
            
            // Test the specific use case from Vue
            const testStatus = 1;
            console.log('Vue use case test - fromValue(' + testStatus + ')?.label:', testEnum.fromValue(testStatus)?.label);
            
            document.getElementById('results').innerHTML = `
                <h2>Test Results</h2>
                <ul>
                    <li>from method exists: ${typeof testEnum.from === 'function'}</li>
                    <li>fromValue method exists: ${typeof testEnum.fromValue === 'function'}</li>
                    <li>from(1): ${JSON.stringify(testEnum.from(1))}</li>
                    <li>fromValue(1): ${JSON.stringify(testEnum.fromValue(1))}</li>
                    <li>fromValue(1)?.label: ${testEnum.fromValue(1)?.label}</li>
                </ul>
            `;
            
        } catch (error) {
            console.error('Test failed:', error);
            document.getElementById('results').innerHTML = `<p>Error: ${error.message}</p>`;
        }
    </script>
</body>
</html>